{"version":3,"file":"index.min.js","sources":["../src/index.js"],"sourcesContent":["console.log('welcome to use formCheck!');\r\n\r\nconst regEmail = /^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/;\r\nconst regPhone = /^[1][3,4,5,7,8][0-9]{9}$/;\r\nconst regWeb = /^((https|http|ftp|rtsp|mms)?:\\/\\/)[^\\s]+/;\r\nconst deaultPassword = /^[a-zA-Z0-9]\\w{5,17}$/;\r\n\r\n\r\nconst deaultStyle = {\r\n\tdisplay: 'inline-block',\r\n\twidth: '80%',\r\n\tpadding: '0.375rem 0.75rem',\r\n\tlineHeight: '1.5',\r\n\tbackgroundColor: '#fff',\r\n\tbackgroundClip: 'padding-box',\r\n\tborder: '1px solid #ced4da',\r\n\tborderRadius: '0.25rem',\r\n\ttransition: 'border-color .15s ease-in-out,box-shadow .15s ease-in-out',\r\n};\r\n\r\nlet svgEyeInput = [];\r\n\r\nconst svgEyeClosed = [\r\n\t'M512 800c-66.112 0-128.32-24.896-182.656-60.096l94.976-94.976A156.256 156.256 0 0 0 512 672c88.224 0 160-71.776 160-160a156.256 156.256 0 0 0-27.072-87.68l101.536-101.536C837.28 398.624 896 493.344 896 512c0 32-171.936 288-384 288m96-288a96 96 0 0 1-96 96c-14.784 0-28.64-3.616-41.088-9.664l127.424-127.424c6.048 12.448 9.664 26.304 9.664 41.088M128 512c0-32 171.936-288 384-288 66.112 0 128.32 24.896 182.656 60.096L277.536 701.216C186.72 625.376 128 530.656 128 512m664.064-234.816l91.328-91.328-45.248-45.248-97.632 97.632C673.472 192.704 595.456 160 512 160 265.248 160 64 443.008 64 512c0 39.392 65.728 148.416 167.936 234.816l-91.328 91.328 45.248 45.248 97.632-97.632C350.528 831.296 428.544 864 512 864c246.752 0 448-283.008 448-352 0-39.392-65.728-148.416-167.936-234.816',\r\n\t'M512 352c-88.224 0-160 71.776-160 160 0 15.328 2.848 29.856 6.88 43.872l58.592-58.592a95.616 95.616 0 0 1 79.808-79.808l58.592-58.592A157.76 157.76 0 0 0 512 352',\r\n];\r\n\r\nconst svgEyeOpen = [\r\n\t'M512 608a96 96 0 1 1 0-192 96 96 0 0 1 0 192m0-256c-88.224 0-160 71.776-160 160s71.776 160 160 160 160-71.776 160-160-71.776-160-160-160',\r\n\t'M512 800c-212.064 0-384-256-384-288s171.936-288 384-288 384 256 384 288-171.936 288-384 288m0-640C265.248 160 64 443.008 64 512c0 68.992 201.248 352 448 352s448-283.008 448-352c0-68.992-201.248-352-448-352',\r\n];\r\n\r\nconst svgClear = [\r\n\t'M512 896C299.936 896 128 724.064 128 512S299.936 128 512 128s384 171.936 384 384-171.936 384-384 384m0-832C264.96 64 64 264.96 64 512s200.96 448 448 448 448-200.96 448-448S759.04 64 512 64',\r\n\t'M665.376 313.376L512 466.752l-153.376-153.376-45.248 45.248L466.752 512l-153.376 153.376 45.248 45.248L512 557.248l153.376 153.376 45.248-45.248L557.248 512l153.376-153.376z',\r\n];\r\n\r\nconst $ = id => {\r\n\treturn document.getElementById(id);\r\n};\r\n\r\nconst setProps = ({\r\n\tlang = 'cn',\r\n\tshowClear = false,\r\n\tshowEye = false,\r\n\tshowHint = true,\r\n\tshowHelp = false,\r\n\tshowAutofix = false,\r\n\tplaceholder = 'please input',\r\n\tisMust = false,\r\n\tmustPosition = 'left',\r\n  type,\r\n  userPassword,\r\n\twithdefaultCSS = true,\r\n}) => ({\r\n\tlang,\r\n\tshowClear,\r\n\tshowEye,\r\n\tshowHint,\r\n\tshowHelp,\r\n\tshowAutofix,\r\n\tplaceholder,\r\n\tisMust,\r\n\tmustPosition,\r\n  type,\r\n  userPassword,\r\n\twithdefaultCSS,\r\n});\r\n\r\nconst init = (id, properties) => {\r\n\tlet input = document.createElement('input');\r\n\tlet prop = setProps(properties || {});\r\n\t$(id).appendChild(input);\r\n\r\n\t// 绑定一个class\r\n\t$(id).childNodes[0].className = 'form-check-input';\r\n\r\n\t// 设置css\r\n\tsetCss(input, deaultStyle, prop.withdefaultCSS);\r\n\r\n\t// 设置placeholder\r\n\tinput.placeholder = prop.placeholder;\r\n\r\n\t// 绑定监听输入\r\n\tlet inputText = watchTyping(id, prop);\r\n\tconsole.log(`目前的值是${inputText}`);\r\n\r\n\t// 展示eye\r\n\tlet eyeRes = isShowEye(id, prop);\r\n\r\n\t// 切换Eye\r\n\tswitchEye(id, prop, eyeRes);\r\n\r\n\t// 展示clear\r\n\tdrawClear(id, prop);\r\n\r\n\t// 是否必填\r\n\tdrawMust(id, prop);\r\n};\r\n\r\nconst setCss = (obj, style, shouldGetCSS) => {\r\n\tif (shouldGetCSS) {\r\n\t\tfor (let attr in style) {\r\n\t\t\tobj.style[attr] = style[attr];\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst watchTyping = (id, prop) => {\r\n\tlet inputNode = $(id).childNodes[0];\r\n\tlet oVal;\r\n\tlet obj = {};\r\n\r\n\tlet proxyInput = new Proxy(inputNode, {\r\n\t\tget: (target, key, receiver) => {\r\n\t\t\treturn Reflect.get(target, key, receiver);\r\n\t\t},\r\n\t\tset: (target, key, value, receiver) => {\r\n\t\t\tif (key === 'text') {\r\n\t\t\t\ttarget[key] = value;\r\n\t\t\t}\r\n\t\t\treturn Reflect.set(target, key, value, receiver);\r\n\t\t},\r\n\t});\r\n\r\n\tinputNode.addEventListener('keyup', e => {\r\n\t\tproxyInput.text = e.target.value;\r\n\t\tconsole.log(`input:${proxyInput.text}`);\r\n\r\n\t\t// 检查格式\r\n\t\tlet formatRes = formatTest(proxyInput.text, prop);\r\n\t\tconsole.log(`${prop.type}+${formatRes}`);\r\n\r\n\t\t// TODO: 渲染hint\r\n\t\tdrawHint(prop);\r\n\t\treturn proxyInput.text;\r\n\t});\r\n};\r\n\r\nconst formatTest = (val, prop) => {\r\n\tlet res;\r\n\tswitch (prop.type) {\r\n\t\tcase 'email':\r\n\t\t\tres = regEmail.test(val);\r\n\t\t\tbreak;\r\n\t\tcase 'phone':\r\n\t\t\tres = regPhone.test(val);\r\n\t\t\tbreak;\r\n\t\tcase 'web':\r\n\t\t\tres = regWeb.test(val);\r\n\t\t\tbreak;\r\n\t\tcase 'password':\r\n\t\t\tres = deaultPassword.test(val);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tres = true;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn res;\r\n};\r\n\r\nconst isShowEye = (id, prop) => {\r\n\t// 需要是密码才显示。\r\n\tlet defaultType = $(id).childNodes[0].type;\r\n\tif (prop.type === 'password' || prop.userPassword || defaultType === 'password') {\r\n\t\t$(id).querySelector('input').type = 'password';\r\n\t\t$(id).querySelector('input').autocomplete = 'on';\r\n\t\tif (prop.showEye) {\r\n      drawEye(id, prop);\r\n      return true;\r\n\t\t}\r\n\t} else {\r\n    return false;\r\n\t}\r\n};\r\n\r\nconst switchEye = (id, prop, showEyeRes) => {\r\n  let svgList = $(id).querySelectorAll('svg');\r\n  console.log(svgList);\r\n\tif (svgList.length>0) {\r\n\t\tsvgList[0].addEventListener('click', () => {\r\n\t\t\tif (showEyeRes) {\r\n        svgEyeInput = svgEyeClosed;\r\n        showEyeRes = !showEyeRes;\r\n\t\t\t\t$(id).querySelector('input').type = 'text';\r\n\t\t\t} else {\r\n        svgEyeInput = svgEyeOpen;\r\n        showEyeRes = !showEyeRes;\r\n\t\t\t\t$(id).querySelector('input').type = 'password';\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\tconsole.log('no svg');\r\n\t}\r\n};\r\n\r\n// TODO\r\nconst drawHint = prop => {};\r\n\r\nconst drawEye = (id, prop) => {\r\n  let svgEyeInput = svgEyeOpen;\r\n\tif (prop.showEye) {\r\n\t\tif (prop.showClear) {\r\n\t\t\tif (prop.isMust) {\r\n\t\t\t\tif (prop.mustPosition === 'right') {\r\n\t\t\t\t\tdrawSVG(id, svgEyeInput, '80px');\r\n\t\t\t\t} else if (prop.mustPosition === 'left') {\r\n\t\t\t\t\tdrawSVG(id, svgEyeInput, '60px');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdrawSVG(id, svgEyeInput, '80px');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (prop.isMust) {\r\n\t\t\t\tif (prop.mustPosition === 'right') {\r\n\t\t\t\t\tdrawSVG(id, svgEyeInput, '65px');\r\n\t\t\t\t} else if (prop.mustPosition === 'left') {\r\n\t\t\t\t\tdrawSVG(id, svgEyeInput, '40px');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdrawSVG(id, svgEyeInput, '60px');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst drawClear = (id, prop) => {\r\n\tif (prop.showClear) {\r\n\t\tif (prop.isMust && prop.mustPosition === 'right') {\r\n\t\t\tdrawSVG(id, svgClear, '60px');\r\n\t\t} else if (prop.isMust && prop.mustPosition === 'left') {\r\n\t\t\tdrawSVG(id, svgClear, '45px');\r\n\t\t} else if (!prop.isMust) {\r\n\t\t\tdrawSVG(id, svgClear, '60px');\r\n\t\t}\r\n\t\tlet svgList = $(id).querySelectorAll('svg');\r\n\t\tsvgList[svgList.length - 1].addEventListener('click', () => {\r\n\t\t\t$(id).querySelector('input').value = '';\r\n\t\t});\r\n\t}\r\n};\r\n\r\nconst drawMust = (id, prop) => {\r\n\tif (prop.isMust) {\r\n\t\tconsole.log('draw must');\r\n\t\tlet must = document.createElement('span');\r\n\t\tmust.innerHTML = '*';\r\n\t\tmust.style.color = 'red';\r\n\t\tmust.style.margin = '0 5px';\r\n\t\tswitch (prop.mustPosition) {\r\n\t\t\tcase 'left':\r\n\t\t\t\tlet inputNode = $(id).childNodes[0];\r\n\t\t\t\t$(id).insertBefore(must, inputNode);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'right':\r\n\t\t\t\t$(id).appendChild(must);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst drawSVG = (id, svgProp, distanceToRight) => {\r\n\tlet svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n\tsvg.setAttribute('width', '18');\r\n\tsvg.setAttribute('height', '18');\r\n\tsvg.setAttribute('viewBox', '0 0 1024 1024');\r\n\tsvg.setAttribute('version', '1.1');\r\n\tsvg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\r\n\r\n\tlet path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n\tpath1.setAttribute('d', svgProp[0]);\r\n\tpath1.setAttribute('fill', '#000');\r\n\r\n\tlet path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n\tpath2.setAttribute('d', svgProp[1]);\r\n\tpath2.setAttribute('fill', '#000');\r\n\r\n\tsvg.appendChild(path1);\r\n\tsvg.appendChild(path2);\r\n\t$(id).appendChild(svg);\r\n\r\n\t$(id).style.position = 'relative';\r\n\tsvg.style.position = 'absolute';\r\n\tsvg.style.top = '8px';\r\n\tsvg.style.right = distanceToRight;\r\n};\r\n\r\nexport { init };\r\n"],"names":["console","log","$","document","getElementById","id","regEmail","regPhone","regWeb","deaultPassword","deaultStyle","svgEyeOpen","svgClear","setCss","obj","style","shouldGetCSS","attr","watchTyping","prop","inputNode","childNodes","proxyInput","Proxy","target","key","receiver","Reflect","get","value","set","addEventListener","text","e","formatRes","formatTest","type","val","res","test","isShowEye","defaultType","userPassword","querySelector","autocomplete","showEye","switchEye","showEyeRes","svgList","querySelectorAll","length","drawEye","svgEyeInput","showClear","isMust","mustPosition","drawClear","drawMust","must","createElement","innerHTML","color","margin","insertBefore","appendChild","drawSVG","svgProp","distanceToRight","svg","createElementNS","setAttribute","path1","path2","position","top","right","properties","input","lang","showHint","showHelp","showAutofix","placeholder","withdefaultCSS","setProps","className","inputText","eyeRes"],"mappings":"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"}